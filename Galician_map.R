#Packages#
####Nota: Error: "grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y polygon edge not found" se soluciona corriendo otra vez la libreria devtool.
install.packages("devtools")
install_github("tidyverse/ggplot2") 
install.packages("tidyverse")
install.packages("sf")
install.packages("ggplot2")

library(ggplot2)
library(RColorBrewer)
library(devtools)
library(sf)
library(tidyverse)

#####READ Galicia MAP #####
Galicia_area <- sf::st_read("MAPAS/Concellos/Concellos_IGN.dbf", quiet = TRUE)
class(Galicia_area)


Galicia_area %>% 
  ggplot() +
  theme_bw() +
  geom_sf(aes(fill = factor(Concello))) +
  scale_colour_brewer() +
  theme(legend.position = "none") +
  labs(title = "Galician map",
       subtitle = "Used for...")

####Socio_ecological Vulnerability by boat#####

Boat_socioecological_vunerability <- read.csv("Boat_to_map.csv", sep = ";")

a <- merge(Galicia_area, Boat_socioecological_vunerability , by="Concello", all.x=TRUE)

a %>% 
  ggplot() +
  geom_sf(aes(fill = SOCIOECOLOGICAL_VUL), show.legend = T) +
  scale_color_brewer()+
  scale_fill_distiller(type = "seq", direction = 1, limits=range(0,1.5))+
  labs(title = "Boat Socio-ecological Vulnerability Map",
       #subtitle = "Concellos",
       fill = "Vulnerability") +
  theme(plot.subtitle=element_text(size=15, hjust=0, face="italic", color="black"))



####Socio_ecological Vulnerability by foot#####

Foot_socioecological_vunerability <- read.csv("Foot_to_map.csv", sep = ";")


b <- merge(Galicia_area, Foot_socioecological_vunerability , by="Concello", all.x=TRUE)

b %>% 
  ggplot() +
  geom_sf(aes(fill = SOCIOECOLOGICAL_VUL), show.legend = T) +
  scale_color_brewer()+
  scale_fill_distiller(type = "seq", direction = 1, palette = "Greens", limits=range(0,1.5))+
  labs(title = "Foot Socio-ecological Vulnerability Map",
       #subtitle = "Concellos",
       fill = "Vulnerability") +

  theme(plot.subtitle=element_text(size=15, hjust=0, face="italic", color="black"))

