#Packages#
library(devtools)
install_github("tidyverse/ggplot2") 
install.packages("tidyverse")
library(tidyverse)
install.packages("sf")
library(sf)
install.packages("ggplot2")
library(ggplot2)


Galicia_area <- sf::st_read("MAPAS/Concellos/Concellos_IGN.dbf", quiet = TRUE)
class(Galicia_area)

Galicia_area %>% 
  ggplot() +
  theme_bw() +
  geom_sf(aes(fill = factor(Concello))) +
  scale_colour_brewer() +
  theme(legend.position = "none") +
  labs(title = "Galician map",
       subtitle = "Used for...")

Galicia_area %>%     ##included on dplyr and only works with tidyverse. To organize better. 
  ggplot() +
  theme_bw() +
  geom_sf() +
  scale_colour_brewer() +
  theme(legend.position = "none") +
  labs(title = "Galician map",
       subtitle = "Used for...")

#filter.base<-world_area[world_area$AREA == 44,]#Base R coding
#filter.dplyr<-filter(world_area, AREA == 44)# dplyr

#a<-filter(world_area, grepl('Spain|France|Italy', NAME)) %>% 
  mutate(value = AREA*REGION)

  
#a %>% 
  ggplot() +
  theme_bw() +
  geom_sf(aes(fill = factor(SUBREGION))) +
  scale_colour_brewer() +
  labs(title = "World map",
       subtitle = "Used for...",
       fill = "SUBREGION") 

  ###
  
Concello <- c('Camariñas','Carnota','Cedeira', 'Cariño', 'Coruña, A', 'Ferrol', 'Fisterra', 'Laxe', 'Malpica de Bergantiños',
                   'Mañón', 'Muxía', 'Muros', 'Pino, O', 'Porto do Son', 'Ribeira', 'Barreiros', 'Cervo', 'Burela', 'Ribadeo', 'Vicedo, O',
                   'Vigo', 'Baiona', 'Blueu', 'Cangas', 'Grove, O', 'Guarda, A', 'Laracha, A', 'Ortigueira', 'Ponteceso', 'Viveiro', 'Ames', 'Ares')
Vulnerability <- c(0,0.2,0.4,0.1,0.2,0.6,1,1.3,1,1.6,2.5,0.8,0,0.2,0.4,0.1,0.2,0.6,1,1.3,1,1.6,2.5,0.8,0.2,0.6,1,1.3,1,1.6, NA, NA)
b<-data.frame(Concello, Vulnerability)
joined <- merge(Galicia_area, b, by="Concello", all.x=TRUE)

joined %>% 
  ggplot() +
  theme_bw() +
  geom_sf(aes(fill = Vulnerability)) +
  scale_colour_brewer() +
  labs(title = "Socio-ecological Vulnerability map",
       subtitle = "Concellos",
       fill = "Vulnerability") 


#
if(!require(broom)){
  install.packages("broom",dependencies = TRUE,repos='http://cran.us.r-project.org')
}
require(broom)
packageVersion("broom")
# [1] â€˜0.4.2â€™

if(!require(ggmap)){
  install.packages("ggmap",dependencies = TRUE,repos='http://cran.us.r-project.org')
}
require(ggmap)
packageVersion("ggmap")
# [1] â€˜2.6.1â€™

if(!require(sp)){
  install.packages("sp",dependencies = TRUE,repos='http://cran.us.r-project.org')
}
require(sp)
packageVersion("sp")
# [1] â€˜1.2.7â€™


if(!require(rgdal)){
  install.packages("rgdal",dependencies = TRUE,repos='http://cran.us.r-project.org')
}
require(rgdal)
packageVersion("rgdal")
# [1] â€˜1.2.20â€™


if(!require(rnaturalearthdata)){
  install.packages("rnaturalearthdata",dependencies = TRUE,repos='http://cran.us.r-project.org')
}
require(rnaturalearthdata)
packageVersion("rnaturalearthdata")
# [1] â€˜0.1.0â€™

if(!require(tidyverse)){
  install.packages("tidyverse",dependencies = TRUE,repos='http://cran.us.r-project.org')
}
require(tidyverse)
packageVersion("tidyverse")
# [1] â€˜1.2.1â€™

#


library(maptools)
library(tidyverse)
library(sf)


library(rgdal)     # R wrapper around GDAL/OGR
library(ggplot2)   # for general plotting
library(ggmaps)    # for fortifying shapefiles

# First read in the shapefile, using the path to the shapefile and the shapefile name minus the
# extension as arguments
shapefile <- readOGR("path/to/shapefile/", "name_of_shapefile")

# Next the shapefile has to be converted to a dataframe for use in ggplot2
shapefile_df <- fortify(shapefile)

# Now the shapefile can be plotted as either a geom_path or a geom_polygon.
# Paths handle clipping better. Polygons can be filled.
# You need the aesthetics long, lat, and group.
map <- ggplot() +
  geom_path(data = shapefile_df, 
            aes(x = long, y = lat, group = group),
            color = 'gray', fill = 'white', size = .2)
Galicia_area <- sf::st_read("Desktop/MAPAS/Concellos_IGN.dbf", quiet = TRUE)
class(world_area)






library(rgdal)
data.shape<-readOGR(dsn="Concellos_ING.shp",layer="Consello")
plot(data.shape)