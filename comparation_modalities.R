#Plot Factor contribution by dimension
#Create manually a colum called dimension.

###BOAT
Boat_exposurse.eco_factors <- read.csv("Boat_ecological_factors.matrix.csv", sep = ";" )
Boat_socioeco.sen_factors <- read.csv("Boat_socioeco_Sensitivity.csv", sep = ";" )
Boat_socioeco.adapt_factors <- read.csv("Boat_socioeco_adapt.csv", sep = ";" )

Boat_exp_factors <- Boat_exposurse.eco_factors %>% gather(FACTOR, value, -fishing.guild, -DIMENSION, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("CLIME","QUANTITY_CHANGE","HABITAT")))

Boat_sen_factors <- Boat_socioeco.sen_factors  %>% gather(FACTOR, value, -fishing.guild, -DIMENSION, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("POUCHN","WORK_OPE","EMPLOY_DIF","PROFIT")))

Boat_adapt.cap_factors <- Boat_socioeco.adapt_factors %>% gather(FACTOR, value, -fishing.guild, -DIMENSION, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("ECONOMIC_STRENGTH","DEPENDENCY","MANAGEMENT_STRATEGIES","LIVELIHOOD_DIV")))

  
  B1 <- ggplot(data=na.omit(Boat_exp_factors), aes(x= fishing.guild , y=value, fill=DIMENSION))+
    geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3, fill = "green4") +
    facet_grid(~FACTOR)+
    coord_flip()+
    theme_classic()+
    ylab("ECOLOGICAL EXPOSURE")+
    xlab("")+
    theme(axis.text.y = element_text(size=10, color="black"),
          axis.text.x = element_text(size=10,color="black",angle=50,hjust=1),
          legend.text = element_text(size=10,color = "black"),
          legend.title = element_text(size=10,color="black"),
          panel.spacing.x = unit(1,"lines"),
          strip.text = element_text(color="black",face="bold",size=11))
  B1 
  ggsave("Figures/Boat_factor_exp.png",width = 10,height = 8,units = "in")
  
  B2 <- ggplot(data=na.omit(Boat_sen_factors), aes(x= fishing.guild , y=value, fill=DIMENSION))+
    geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3, fill = "orange2") +
    facet_grid(~FACTOR)+
    coord_flip()+
    theme_classic()+
    ylab("SENSITIVITY")+
    xlab("")+
    theme(axis.text.y = element_text(size=10, color="black"),
          axis.text.x = element_text(size=10,color="black",angle=50,hjust=1),
          legend.text = element_text(size=10,color = "black"),
          legend.title = element_text(size=10,color="black"),
          panel.spacing.x = unit(1,"lines"),
          strip.text = element_text(color="black",face="bold",size=11))
  B2
  ggsave("Figures/Boat_factor_sen.png",width = 10,height = 8,units = "in")

  B3 <- ggplot(data=na.omit(Boat_adapt.cap_factors), aes(x= fishing.guild , y=value, fill=DIMENSION))+
    geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3, fill = "purple2") +
    facet_grid(~FACTOR)+
    coord_flip()+
    theme_classic()+
    ylab("ADAPTIVE CAPACITY")+
    xlab("")+
    theme(axis.text.y = element_text(size=10, color="black"),
          axis.text.x = element_text(size=10,color="black",angle=50,hjust=1),
          legend.text = element_text(size=10,color = "black"),
          legend.title = element_text(size=10,color="black"),
          panel.spacing.x = unit(1,"lines"),
          strip.text = element_text(color="black",face="bold",size=11))
  B3
  ggsave("Figures/Boat_factor_adapt.png",width = 10,height = 8,units = "in")
  
###FOOT
Foot_Eco_factors <- read.csv("Foot_ecological_factors.matrix.csv", sep = ";" )
Foot_socioeco.sen_factors <- read.csv("Foot_socioeco_sen.factor.csv", sep = ";" )
Foot_socioeco.adapt_factors <- read.csv("Foot_socioeco_adapt.csv", sep = ";" )

Foot_exp_factors <- Foot_Eco_factors %>% gather(FACTOR, value, -fishing.guild, -DIMENSION, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("CLIME","QUANTITY_CHANGE","HABITAT")))

Foot_sen_factors <- Foot_socioeco.sen_factors  %>% gather(FACTOR, value, -fishing.guild, -DIMENSION, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("POUCHN","WORK_OPE","EMPLOY_DIF","PROFIT")))

Foot_adapt.cap_factors <- Foot_socioeco.adapt_factors %>% gather(FACTOR, value, -fishing.guild, -DIMENSION, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("ECONOMIC_STRENGTH","DEPENDENCY","MANAGEMENT_STRATEGIES","LIVELIHOOD_DIV")))

F1 <- ggplot(data=na.omit(Foot_exp_factors), aes(x= fishing.guild , y=value, fill=DIMENSION))+
  geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3, fill = "green4") +
  facet_grid(~FACTOR)+
  coord_flip()+
  theme_classic()+
  ylab("ECOLOGICAL EXPOSURE")+
  xlab("")+
  theme(axis.text.y = element_text(size=10, color="black"),
        axis.text.x = element_text(size=10,color="black",angle=50,hjust=1),
        legend.text = element_text(size=10,color = "black"),
        legend.title = element_text(size=10,color="black"),
        panel.spacing.x = unit(1,"lines"),
        strip.text = element_text(color="black",face="bold",size=11))
F1 
ggsave("Figures/Foot_factor_exp.png",width = 10,height = 8,units = "in")

F2 <- ggplot(data=na.omit(Foot_sen_factors), aes(x= fishing.guild , y=value, fill=DIMENSION))+
  geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3, fill = "orange2") +
  facet_grid(~FACTOR)+
  coord_flip()+
  theme_classic()+
  ylab("SENSITIVITY")+
  xlab("")+
  theme(axis.text.y = element_text(size=10, color="black"),
        axis.text.x = element_text(size=10,color="black",angle=50,hjust=1),
        legend.text = element_text(size=10,color = "black"),
        legend.title = element_text(size=10,color="black"),
        panel.spacing.x = unit(1,"lines"),
        strip.text = element_text(color="black",face="bold",size=11))
F2 
ggsave("Figures/Foot_factor_sen.png",width = 10,height = 8,units = "in")

F3 <- ggplot(data=na.omit(Foot_adapt.cap_factors), aes(x= fishing.guild , y=value, fill=DIMENSION))+
  geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3, fill = "purple2") +
  facet_grid(~FACTOR)+
  coord_flip()+
  theme_classic()+
  ylab("ADAPTIVE CAPACITY")+
  xlab("")+
  theme(axis.text.y = element_text(size=10, color="black"),
        axis.text.x = element_text(size=10,color="black",angle=50,hjust=1),
        legend.text = element_text(size=10,color = "black"),
        legend.title = element_text(size=10,color="black"),
        panel.spacing.x = unit(1,"lines"),
        strip.text = element_text(color="black",face="bold",size=11))
F3 
ggsave("Figures/Foot_factor_adapt.png",width = 10,height = 8,units = "in")

#Conjunto

Both_Eco_factors <- read.csv("FACTOR_exp_modalities.csv", sep = ";" )
EXPOSURE_BOTH <- Both_Eco_factors %>% gather(FACTOR, value, -fishing.guild, -DIMENSION, -MODALITY, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("CLIME","QUANTITY_CHANGE","HABITAT")))

F1 <- ggplot(data=na.omit(EXPOSURE_BOTH), aes(x= fishing.guild , y=value, fill=MODALITY, group=MODALITY))+
  geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3) +
  facet_grid(~FACTOR)+
  coord_flip()+
  theme_classic()+
  ylab("")+
  xlab("fishing.guild")+
  theme(axis.text.y = element_text(size=10, color="black"),
        axis.text.x = element_text(size=10,color="black",angle=50,hjust=1),
        legend.text = element_text(size=10,color = "black"),
        legend.title = element_text(size=10,color="black"),
        panel.spacing.x = unit(1,"lines"),
        strip.text = element_text(color="black",face="bold",size=11))
F1 
ggsave("Figures/Foot_factor_exp.png",width = 10,height = 8,units = "in")
